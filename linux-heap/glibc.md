# glibc heap

## Bins

- Used to keep track of freed chunks
    - Tcache
    - Fast bin
        - Signly linked list (`fd`)
        - LIFO
        - Size range from 0x20 ~ 0x80 (8 bins)
        - One size per bin
        - `PREV_IN_USE` flag won’t be cleared if the freed chunk is placed in fast bin
    - Unsorted bin
        - Circular doubly linked list (`fd`, `bk`)
        - Temporary cache for small bin & large bin (1 bin only)
        - A chunk is placed into the unsorted bin if
            - The chunk size is greater than the maximum tcache size (0x420)
            - The chunk size is in the tcache range and the tcache is full
        - `malloc` will search through unsorted bin. During the search if
            - A chunk with the same size return the chunk directly
            - If a chunk is bigger than the requested chunk → the [remaindering]() process will happen.
            - Otherwise → the chunk is placed in small bin or large bin
    - Small bin
        - Circular doubly linked list (`fd`, `bk`)
        - FIFO
        - Chunk size from 0x20 ~ 0x3f0 (62 bins)
        - One size per bin
        - The head of each small bin resides in the arena (a libc address for main arena)
        - A chunk will be placed into a smallbin only from the unsortedbin
