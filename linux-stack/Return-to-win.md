# Return-to-win (ret2win)

## Scenario

- Stack overflow
- Stack not writable
- A backdoor `win` function exists in the binary
    ```c
    void win() {
        system("/bin/sh");
    }
    ```

## Method

- Overwrite the return address to `win`.

## Stack layout

| Original stack layout | Overwritten stack layout |
| :-: | :-: |
| `local variable` | `local variable` |
| `overflowed buffer` | **`0x41414141`** |
| `overflowed buffer` | **`0x41414141`** |
| `old stack frame` | **`0x41414141`** |
| `return address` | **`win`** |
