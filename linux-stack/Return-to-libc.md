# Return-to-libc (ret2libc)

## Requirement

- Stack overflow
- Stack not executable

## Idea

- Overwrite the **return address** to an address of a **libc subroutine**.

## Bypass

- Bypass canary
    - Leak canary
    - Brute force canary
        - If the child process is forked, then *the same canary will be used* (The canary is inherited from the parent)
        - You can brute force the canary byte-by-byte
            - If the program does not crash, you can know that the guessed canary byte was correct
- Bypass ASLR
    - Leak **library address (Required)** / stack address / executable base address / ...
    - Brute force PIE address
        - Similar to brute-forcing canary
## Stack layout

| Original stack layout | Overwritten stack layout |
| :-: | :-: |
| `local variable` | `local variable` |
| `overflowed buffer` | **`0x41414141`** |
| `overflowed buffer` | **`0x41414141`** |
| `old stack frame` | **`0x41414141`** |
| `return address` | **`libc system address`** |
| ... | **`dummy return address`** |
| ... | **`"/bin/sh" address`** |
